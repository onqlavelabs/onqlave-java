name: Maven CI/CD

on:
  pull_request:
    branches: [ main ]

jobs:
  build_and_test:

    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3
      - name: Set up JDK
        uses: actions/setup-java@v3
        with:
          distribution: 'oracle'
          java-version: '17'

      - name: Maven Test
        run: mvn --batch-mode --no-transfer-progress test
        env:
          AES_128_ACCESS_KEY: ${{ secrets.AES_128_ACCESS_KEY_PROD }}
          AES_128_ARX_URL: ${{ secrets.AES_128_ARX_URL_PROD }}
          AES_128_SIGNING_KEY: ${{ secrets.AES_128_SIGNING_KEY_PROD }}
          AES_128_SECRET_KEY: ${{ secrets.AES_128_SECRET_KEY_PROD }}

          AES_256_ACCESS_KEY: ${{ secrets.AES_256_ACCESS_KEY_PROD }}
          AES_256_ARX_URL: ${{ secrets.AES_256_ARX_URL_PROD }}
          AES_256_SIGNING_KEY: ${{ secrets.AES_256_SIGNING_KEY_PROD }}
          AES_256_SECRET_KEY: ${{ secrets.AES_256_SECRET_KEY_PROD }}

          XCHACHA_ACCESS_KEY: ${{ secrets.XCHACHA_ACCESS_KEY_PROD }}
          XCHACHA_ARX_URL: ${{ secrets.XCHACHA_ARX_URL_PROD }}
          XCHACHA_SIGNING_KEY: ${{ secrets.XCHACHA_SIGNING_KEY_PROD }}
          XCHACHA_SECRET_KEY: ${{ secrets.XCHACHA_SECRET_KEY_PROD }}
